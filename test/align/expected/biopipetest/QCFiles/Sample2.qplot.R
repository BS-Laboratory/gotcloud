NFiles=2;
colvec=c(1,2);
grid.col='gray';
pchvec=c(1,2);
legend.txt=c('Sample2_recal','Sample2_dedup');
lty.vec=c(1);
pdf(file="", height=12, width=12);
par(mfrow=c(2,2)); par(cex.main=1.4); par(cex.lab=1.2); par(cex.axis=1.2);par(mar=c(5.1, 4.1, 4.1, 4.1))
X=vector("list", NFiles);
Y=vector("list", NFiles);
Z=vector("list", NFiles);
x = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36);
y = c(0.076,1.596,3.058,13.460,5.521,16.437,19.381,19.489,24.756,23.357,29.762,32.397,31.488,33.199,34.195,38.350,36.310,30.455,50,26.107,50,9.542,50,26.031,50,50,50,50,50,50,50,50,50,50,50,50,50);
if(length(x)==0) x = NA; X[[1]] = x;
if(length(y)==0) y = NA; Y[[1]] = y;
x = c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39);
y = c(3.789,4.771,5.653,6.172,6.170,6.751,7.942,8.200,9.740,11.060,12.215,12.651,12.732,14.431,15.415,16.722,17.014,20.328,19.729,21.152,21.321,25.051,24.638,23.898,26.234,27.613,28.024,28.948,28.243,30.011,30.268,32.990,33.302,30.715,33.788,32.869,50,50);
if(length(x)==0) x = NA; X[[2]] = x;
if(length(y)==0) y = NA; Y[[2]] = y;
z = c(0.001,0.000,0.001,0.008,0.001,0.012,0.013,0.014,0.028,0.014,0.033,0.024,0.017,0.017,0.011,0.007,0.004,0.003,0.001,0.001,0.000,0.000,0.000,0.000,0.001,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000);
if(length(z)==0) z = NA; Z[[1]] = z;
z = c(0.000,0.000,0.000,0.001,0.002,0.002,0.002,0.002,0.004,0.002,0.002,0.003,0.002,0.004,0.004,0.003,0.003,0.004,0.004,0.006,0.005,0.005,0.006,0.008,0.009,0.009,0.010,0.010,0.011,0.012,0.012,0.014,0.015,0.021,0.012,0.002,0.001,0.000);
if(length(z)==0) z = NA; Z[[2]] = z;
MAX.X=0; MAX.Y=0; MAX.Z=0;
 for(i in 1:NFiles){
m.x=max(X[[i]]);
if(length(Y[[i]])==1 & is.na(Y[[i]][1]) | length(which(!is.na(Y[[i]])))==0)m.y=NA else m.y=max(Y[[i]][which(!is.na(Y[[i]]))]);
m.z=max(Z[[i]]);
if(!is.na(m.x) & MAX.X<m.x) MAX.X=m.x;
if(!is.na(m.y) & MAX.Y<m.y) MAX.Y=m.y;
if(!is.na(m.z) & MAX.Z<m.z) MAX.Z=m.z;
}
plot(X[[1]],Y[[1]],xlab='Reported Phred', ylab='Empirical Phred', xlim=range(0, MAX.X*1.2), ylim=range(0, max(MAX.X,MAX.Y)), type='l',col=colvec[1], main=' Empirical vs reported Phred score');
if(NFiles>1)
 for(i in 2:NFiles) points(X[[i]], Y[[i]], col=colvec[i], type='l');
points(x,x,col='purple', type='l');
ratio = MAX.Z/20;
for(i in 1:NFiles) {points(X[[i]][1:length(X[[i]])], Z[[i]][1:length(Z[[i]])]/ratio, col=colvec[i], type='l', lty=2);
}
legend("topright",legend=legend.txt, col=colvec, lty=lty.vec);
abline(v=pretty(seq(MAX.X*1.2), n= 10), lty="dotted", col = "lightgray")
abline(h=pretty(seq(MAX.Y), n= 10), lty="dotted", col = "lightgray")
mtext(text="Base Count (M)", side=4, line= 2.5, cex=par()$cex*1.2)
axis.left.tick = pretty(seq(MAX.Y))
axis.right.tick = axis.left.tick[axis.left.tick <= 20]
axis.right.text = round(ratio * axis.right.tick, 1)
axis(side = 4, at = axis.right.tick, labels= axis.right.text)

x = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76);
y = c(23.036,23.059,21.315,21.494,20.957,21.138,20.063,21.885,20.201,20.972,23.363,22.101,20.641,20.650,19.214,20.796,20.639,21.503,18.775,19.689,20.803,21.668,23.315,21.092,19.149,19.858,20.273,19.010,19.471,18.786,19.345,20.107,18.778,18.478,20.546,16.880,18.764,17.910,19.302,18.455,18.266,17.722,17.871,17.398,16.948,17.440,18.489,17.058,17.815,17.257,16.237,16.450,15.768,15.957,15.811,16.507,15.354,15.598,15.469,15.104,14.590,14.917,15.709,14.916,14.476,15.178,14.750,14.713,14.694,13.633,12.152,11.068,9.785,7.877,8.751,6.864);
X[[1]] = x;
Y[[1]] = y;
x = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76);
y = c(23.036,23.059,21.315,21.494,20.957,21.138,20.063,21.885,20.201,20.972,23.363,22.101,20.641,20.650,19.214,20.796,20.639,21.503,18.775,19.689,20.803,21.668,23.315,21.092,19.149,19.858,20.273,19.010,19.471,18.786,19.345,20.107,18.778,18.478,20.546,16.880,18.764,17.910,19.302,18.455,18.266,17.722,17.871,17.398,16.948,17.440,18.489,17.058,17.815,17.257,16.237,16.450,15.768,15.957,15.811,16.507,15.354,15.598,15.469,15.104,14.590,14.917,15.709,14.916,14.476,15.178,14.750,14.713,14.694,13.633,12.152,11.068,9.785,7.877,8.751,6.864);
X[[2]] = x;
Y[[2]] = y;
z = c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3273);
Z[[1]] = z/1000000;
z = c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3273);
Z[[2]] = z/1000000;
MAX=0;MIN.Y=999999999; MAX.Z=0; 
 for(i in 1:NFiles){
if(length(which(!is.na(Y[[i]])))==0){m=NA; mm=NA;} else {m=max(Y[[i]][which(!is.na(Y[[i]]))]);mm=min(Y[[i]][which(!is.na(Y[[i]]))]);}; m.z=max(Z[[i]]); 
 if(!is.na(m) & MAX<m) MAX=m; if(!is.na(mm) & MIN.Y>mm) MIN.Y=mm; if(MAX.Z<m.z) MAX.Z=m.z; 
}
plot(X[[1]],Y[[1]], xlim=range(1, length(X[[1]])*1.2), ylim=range(0,MAX*1.2), xlab='Cycle', ylab='Empirical Phred', type='l',col=colvec[1], main=' Empirical Phred score by cycle');
if(NFiles>1)
 for(i in 2:NFiles) points(X[[i]], Y[[i]], col=colvec[i], type='l');
ratio = MIN.Y/MAX.Z;
for(i in 1:NFiles) points(X[[i]], Z[[i]]*ratio/1.2, col=colvec[i], type='l', lty=2);
legend("topright",legend=legend.txt, col=colvec, lty=lty.vec);
abline(v=pretty(range(1, length(X[[1]])*1.2), n= 10), lty="dotted", col = "lightgray")
abline(h=pretty(seq(MAX.Y), n= 10), lty="dotted", col = "lightgray")
mtext(text="Read Count (M)", side=4, line= 2.5, cex=par()$cex*1.2)
axis.left.tick = pretty(seq(MAX.Y))
axis.right.tick = axis.left.tick[axis.left.tick <= 20]
axis.right.text = round(ratio * axis.right.tick, 1)
axis(side = 4, at = axis.right.tick, labels= axis.right.text)

z = c(1717,1500,2329,2285,2093,2184,2506,2991,4021,4874,5859,6978,8012,10499,15566,22592,33605,49646,71004,101234,143814,200394,270206,356402,458741,572907,699869,835056,974502,1112700,1253114,1385015,1505984,1616317,1719434,1808010,1882132,1931594,1964924,1981248,1983243,1976495,1968813,1967829,1971190,1981459,1993259,1993797,1956731,1889212,1796523,1684630,1572563,1467535,1373573,1274662,1169398,1049862,917602,782115,657645,549670,457252,379853,314628,258881,212733,170122,134723,104534,81187,64368,51003,41830,34612,30040,27084,25006,21864,19003,16344,14170,11498,8973,6918,4859,3157,2189,1314,832,722,435,343,180,128,40,25,31,0,0);
x = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100);
y = c(NA,NA,NA,NA,0.669,0.669,0.669,0.669,0.669,0.669,1.339,1.052,1.130,1.133,1.101,1.148,1.101,1.097,0.971,0.976,0.998,1.101,1.109,1.100,1.112,1.117,1.127,1.090,1.082,1.095,1.079,1.072,1.066,1.035,1.033,1.013,1.015,1.028,1.014,1.011,1.000,0.991,1.002,1.006,1.002,0.998,1.005,1.007,0.984,0.970,0.961,0.967,0.957,0.967,0.960,0.918,0.908,0.918,0.907,0.888,0.909,0.898,0.888,0.878,0.924,0.902,0.893,0.873,0.934,0.832,0.801,0.896,0.896,0.829,0.688,0.730,0.781,0.860,0.769,0.719,0.744,1.100,1.339,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA);
X[[1]] = x;
Y[[1]] = y;
x = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100);
y = c(NA,NA,NA,NA,0.669,0.669,0.669,0.669,0.669,0.669,1.339,1.052,1.130,1.133,1.101,1.148,1.101,1.097,0.971,0.976,0.998,1.101,1.109,1.100,1.112,1.117,1.127,1.090,1.082,1.095,1.079,1.072,1.066,1.035,1.033,1.013,1.015,1.028,1.014,1.011,1.000,0.991,1.002,1.006,1.002,0.998,1.005,1.007,0.984,0.970,0.961,0.967,0.957,0.967,0.960,0.918,0.908,0.918,0.907,0.888,0.909,0.898,0.888,0.878,0.924,0.902,0.893,0.873,0.934,0.832,0.801,0.896,0.896,0.829,0.688,0.730,0.781,0.860,0.769,0.719,0.744,1.100,1.339,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA);
X[[2]] = x;
Y[[2]] = y;
MAX=0;
 for(i in 1:NFiles){
 x=X[[i]][20:80];
 y=Y[[i]][20:80]; 
if(length(which(!is.na(y)))==0)m=NA else m=max(y[which(!is.na(y))]);
if(!is.na(m) & MAX<m) MAX=m;
}
mm=vector(); mat=vector();
for(i in 1:NFiles) mat = rbind(mat, Y[[i]]);
mm=sapply(data.frame(mat), min);
plot(X[[1]],Y[[1]], xlim=range(0,120), ylim=range(0,MAX*1.2), xlab='GC content', ylab='Normalized mean depth', type='l', col=colvec[1], main=' Mean depth vs. GC');
if(NFiles>1) 
 for(i in 2:NFiles) points(X[[i]], Y[[i]], col=colvec[i], type='l');
abline(h=1.0, col='red', lty=2);
zz = (z/1000)/(sum(z/1000));
mm.r = mm/zz; mm.r.mid = mm.r[20:80]; if(length(which(!is.na(mm.r.mid)))==0)min.r=NA else min.r = min(mm.r.mid[!is.na(mm.r.mid)]); 
 z = zz*max(2,(min.r*0.5)); 
points(X[[1]], z, type='h', col='purple');
legend("topright", legend=legend.txt, col=colvec, lty=lty.vec);
abline(v=pretty(range(0,120), n= 10), lty="dotted", col = "lightgray")
abline(h=pretty(range(0,MAX*1.2), n= 10), lty="dotted", col = "lightgray")

x = c(65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,111,112,114,115,117,118,122,123,129,131,133,135,139,153,163,165,166,177,180,182,193,2102547,35392245,39337895,41829788);
y = c(1,2,5,17,21,29,50,51,60,67,81,93,89,72,93,90,72,84,54,51,50,48,34,40,21,16,16,12,15,6,4,7,4,4,9,3,5,4,6,3,7,3,3,1,1,2,1,2,2,1,1,1,1,2,2,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1);
if(length(x)==0) x=NA; if(length(y)==0) y=NA;
X[[1]] = x;
Y[[1]] = y;
x = c(65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,111,112,114,115,117,118,122,123,129,131,133,135,139,153,163,165,166,177,180,182,193,2102547,35392245,39337895,41829788);
y = c(1,2,5,17,21,29,50,51,60,67,81,93,89,72,93,90,72,84,54,51,50,48,34,40,21,16,16,12,15,6,4,7,4,4,9,3,5,4,6,3,7,3,3,1,1,2,1,2,2,1,1,1,1,2,2,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1);
if(length(x)==0) x=NA; if(length(y)==0) y=NA;
X[[2]] = x;
Y[[2]] = y;
MAX.X=0; MAX.Y=0; MIN.X=999999999; 
 for(i in 1:NFiles){
if(is.na(X[[i]][1])) next; 
 x=X[[i]];
 y=Y[[i]]; 
 m.y=max(y[which(!is.na(y))]);
 if(MAX.Y<m.y) MAX.Y=m.y;
 m.x=x[which(y==m.y)[1]];
 if(MAX.X<m.x) MAX.X=m.x;
 if(MIN.X>m.x) MIN.X=m.x;
 }
plot(X[[1]],Y[[1]]/1000000, xlim=range(MIN.X-150, MAX.X+150), ylim=range(0,MAX.Y/1000000*1.2), xlab='Insert size', ylab='Count in million', type='l', col=colvec[1], main=' Insert size distribution');
if(NFiles>1) 
 for(i in 2:NFiles) points(X[[i]], Y[[i]]/1000000, col=colvec[i], type='l');
legend("topright",legend=legend.txt, col=colvec, lty=lty.vec);
abline(v=pretty(range(MIN.X-150, MAX.X+150), n= 10), lty="dotted", col = "lightgray")
abline(h=pretty(range(0,MAX.Y/1000000*1.2), n= 10), lty="dotted", col = "lightgray")

x = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76);
y = c(3107,2660,2461,2512,2473,2485,2411,2578,2511,2483,2517,2483,2567,2476,2502,2547,2466,2497,2506,2472,2430,2566,2541,2462,2414,2466,2525,2418,2331,2340,2470,2454,2333,2351,2438,2390,2447,2456,2484,2344,2308,2411,2369,2307,2377,2341,2377,2402,2251,2229,2397,2243,2296,2401,2333,2171,2172,2186,1943,1985,1852,1835,1715,1570,1408,1361,1406,1165,1146,1001,745,534,209,3,1,1);
X[[1]] = x;
Y[[1]] = y;
x = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76);
y = c(2993,2942,2898,2929,2988,2916,2905,2982,2904,2958,2990,2992,2995,3036,2959,3013,2934,2975,2937,2992,2945,2936,2925,2920,2840,2902,2834,2746,2779,2783,2785,2732,2737,2701,2690,2668,2693,2509,2479,2627,2571,2531,2489,2363,2493,2466,2526,2447,2389,2371,2356,2247,2211,2058,2127,1974,2034,1961,1784,1751,1768,1645,1335,1346,1376,1274,1162,1122,779,429,72,23,6,2,5,16);
X[[2]] = x;
Y[[2]] = y;
MAX=0;MIN.Y=999999999; MAX.Z=0; 
 for(i in 1:NFiles){
if(length(which(!is.na(Y[[i]])))==0){m=NA; mm=NA;} else {m=max(Y[[i]][which(!is.na(Y[[i]]))]);mm=min(Y[[i]][which(!is.na(Y[[i]]))]);}; m.z=max(Z[[i]]); 
 if(!is.na(m) & MAX<m) MAX=m; if(!is.na(mm) & MIN.Y>mm) MIN.Y=mm; if(MAX.Z<m.z) MAX.Z=m.z; 
}
plot(X[[1]],Y[[1]], xlim=range(1, length(X[[1]])*1.2), ylim=range(0,MAX*1.2), xlab='Cycle', ylab='Empirical Q20 base count', type='l',col=colvec[1], main=' Empirical Q20 base count by cycle');
if(NFiles>1)
 for(i in 2:NFiles) points(X[[i]], Y[[i]], col=colvec[i], type='l');
legend("topright",legend=legend.txt, col=colvec, lty=lty.vec);
abline(v=pretty(range(1, length(X[[1]])*1.2), n= 10), lty="dotted", col = "lightgray")
abline(h=pretty(range(0,MAX*1.2), n= 10), lty="dotted", col = "lightgray")

x = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254);
y = c(70883,71188,72,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);
X[[1]] = x;
Y[[1]] = y;
x = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254);
y = c(70883,71188,72,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);
X[[2]] = x;
Y[[2]] = y;
total.site = 63025520
depth.legend.txt = legend.txt
for(i in 1:NFiles){depth.legend.txt[i] = paste(legend.txt[i], '  (No coverage = ',round((1-sum(Y[[i]])/total.site)*100,2), '% )'); Y[[i]]=(sum(Y[[i]]) - cumsum(Y[[i]]))/total.site * 100; }
MAX.X=0; MAX.Y=0; 
for(i in 1:NFiles){
 tmp = length(which(Y[[i]] > max(Y[[i]])*0.6)) ; 
 if (tmp < 10) tmp = 10; 
 if (MAX.X < tmp) MAX.X = tmp; 
 if (MAX.Y < max(Y[[i]])) MAX.Y = max(Y[[i]]); }
plot(X[[1]],Y[[1]], xlim=range(1, MAX.X), ylim=range(0,MAX.Y*1.2), xlab='Depth', ylab='Percentage of covered sites', pch = '+', type='b', col=colvec[1], main=' Depth distribution');
if(NFiles>1) 
 for(i in 2:NFiles) points(X[[i]], Y[[i]], col=colvec[i], pch = '+', type='b');
legend("topright",legend=depth.legend.txt, col=colvec, lty=lty.vec);
abline(v=pretty(range(0,MAX.X), n= 10), lty="dotted", col = "lightgray")
abline(h=pretty(range(0,MAX.Y*1.2), n= 10), lty="dotted", col = "lightgray")

labelvec=c('Sample2_recal','Sample2_dedup');
legend.txt=c('Total', 'Mapped', 'Paired', 'ProperPair','Dup', 'QCFail');
x=c(0.010,0.010);
y=c(0.003,0.003);
z=c(0.010,0.010);
u=c(0.002,0.002);
v=c(0.000,0.000);
w=c(0.000,0.000);
pchvec=c(1,2,3,4,5,6); colvec=c(1,2,3,4,5,6);
plot(x, xlab='Bam file index', ylab='Read count in million', ylim=range(0, max(x)*1.4), main=' Flag stats', pch=pchvec[1],col=colvec[1], type='b', axes=F);
points(y, pch=pchvec[2], col=colvec[2], type='b');
points(z, pch=pchvec[3], col=colvec[3], type='b');
points(u, pch=pchvec[4], col=colvec[4], type='b');
points(v, pch=pchvec[5], col=colvec[5], type='b');
points(w, pch=pchvec[6], col=colvec[6], type='b');
axis(side=1, at=c(1:length(x)), labels=labelvec);
axis(side=2);
box(); 
legend("topleft", legend=legend.txt, col=c(1,2,3,4,5,6), lty=1, pch=pchvec, merge=TRUE, horiz=F,cex=0.9);
abline(v=seq(x), lty="dotted", col = "lightgray")
abline(h=pretty(seq(0, max(x)*1.4), n= 10), lty="dotted", col = "lightgray")

x1=c(1.494,1.494);
x2=c(0.161,0.172);
ratio = max(x2)/max(x1);
if (ratio > 5 || (ratio < 1/5 && ratio >= 1e-10)) {;
x2 = x2 / ratio;
} else {;
ratio = 1;
};
ylim = range(-max(x2), max(x1)) * 1.2;
y1lim = range(0, max(x1)) * 1.2;
y2lim = range(-max(x2), 0) * 1.2;
barplot(x1, ylim= ylim, axes = F, names.arg=c('Sample2_recal','Sample2_dedup'), xlab='Bam file index', col='light blue', main='\nMean depth of sequencing / Empirical Q20 count');
barplot(-x2, ylim= ylim, axes = F, add = T, col = 'light pink');
tick.pos = pretty(y1lim);
tick.text = as.character(pretty(y1lim));
tick.text[1] = NA;
axis(side = 2, at = tick.pos, labels = tick.text );
abline(h=tick.pos, lty="dotted", col = "lightgray");
tick.pos = pretty(y2lim*ratio)/ratio;
axis(side = 2, at = tick.pos, labels= as.character(-pretty(y2lim*ratio)));
abline(h=tick.pos, lty="dotted", col = "lightgray");
mtext(side = 2, 'Mean depth', adj = 1, line = 3, cex = par()$cex * 1.2);
mtext(side = 2, 'Q20 count in million', adj = 0, line = 3, cex = par()$cex * 1.2);

q()
